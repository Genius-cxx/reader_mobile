webpackJsonp([10],{"1vNL":function(t,e){},"4fS7":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});o("miO0");var a=o("OTYB"),n=o.n(a),s=o("4YfN"),i=o.n(s),r=o("48sp"),l=o("eFLg"),c=o("P9l9"),k={data:function(){return{largeTypeIndex:0,title:"",largeTypes:[{name:"周榜",type:"week"},{name:"月榜",type:"month"},{name:"总榜",type:"total"}],bookLists:[],allLoaded:!1,monthRank:"",totalRank:"",weekRank:"",currentLoadPage:1,type:"week",ranks:!0,isLoadMore:!1}},computed:i()({},Object(r.b)(["rank"])),methods:{setLargeType:function(t,e){this.$refs.load.scrollTop=0,this.bookLists=[],this.currentLoadPage=1,this.largeTypeIndex=e,this.type=t,this.allLoaded=!1,this._getBookLists(t)},_getBookLists:function(t){var e=this;n.a.open("加载中"),this.rank.weekRank?(this.weekRank=this.rank.weekRank,this.monthRank=this.rank.monthRank,this.totalRank=this.rank.totalRank):Object(c.j)(this.$route.params.id).then(function(t){e.weekRank=t.data.ranking.id,e.monthRank=t.data.ranking.monthRank,e.totalRank=t.data.ranking.totalRank,e.title=t.data.ranking.title}),t=t?this[t+"Rank"]:this.$route.params.id,Object(c.j)(t).then(function(t){t.data.ok?(e.bookLists=e._unEscape(e.normalizeBooks(t.data.ranking.books.slice(0,20))),n.a.close()):(e.bookLists=[],n.a.close())},function(t){n.a.close(),n.a.open("网络错误"),setTimeout(function(){n.a.close()},1500)})},_unEscape:function(t){for(var e=0;e<t.length;e++)t[e].cover=unescape(t[e].cover),t[e].cover=t[e].cover.replace("/agent/","");return t},loadBottom:function(){var t=this;this.isLoadMore=!0,n.a.open("加载中"),Object(c.j)(this[this.type+"Rank"]).then(function(e){e.data.ok&&(t.bookLists.length===e.data.ranking.books.length&&(t.allLoaded=!0),t.bookLists=t._unEscape(t.normalizeBooks(e.data.ranking.books.slice(0,20*t.currentLoadPage+20))),t.currentLoadPage++,setTimeout(function(){n.a.close(),t.isLoadMore=!1},350))},function(t){n.a.close(),n.a.open("网络错误"),setTimeout(function(){n.a.close()},1500)}),this.$refs.loadmore.onBottomLoaded()},loadTop:function(){var t=this;n.a.open("加载中"),Object(c.j)(this[this.type+"Rank"]).then(function(e){e.data.ok&&(t.bookLists=t._unEscape(t.normalizeBooks(e.data.ranking.books.slice(0,20))),setTimeout(function(){n.a.close()},350))},function(t){n.a.close(),n.a.open("网络错误"),setTimeout(function(){n.a.close()},1500)}),this.$refs.loadmore.onTopLoaded()}},components:{BookList:l.a},beforeRouteEnter:function(t,e,o){o(function(t){t.title=t.$route.query.title,t._getBookLists(),t.largeTypeIndex=0})}},d={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"bookLists"},[o("mt-header",{staticClass:"book-header",attrs:{title:t.title}},[o("router-link",{attrs:{slot:"left",to:"/rank"},slot:"left"},[o("mt-button",{attrs:{icon:"back"}},[t._v("返回")])],1)],1),t._v(" "),o("div",{staticClass:"select"},[o("ul",{staticClass:"select-bar"},t._l(t.largeTypes,function(e,a){return o("li",{class:{active:a===t.largeTypeIndex},on:{click:function(o){return t.setLargeType(e.type,a)}}},[t._v(t._s(e.name)+"\n      ")])}),0)]),t._v(" "),o("div",{ref:"load",staticClass:"load-more"},[o("mt-loadmore",{ref:"loadmore",attrs:{"bottom-method":t.loadBottom,"top-method":t.loadTop,"auto-fill":!1,"bottom-all-loaded":t.allLoaded}},[o("div",{staticClass:"book-list"},[t._l(t.bookLists,function(e,a){return o("book-list",{key:a,attrs:{book:e,ranks:t.ranks,isLoadMore:t.isLoadMore}})}),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!t.bookLists.length,expression:"!bookLists.length"}],staticClass:"loading-container"},[o("div",{staticStyle:{"text-align":"center","margin-top":"10px"}},[t._v("没有找到更多书籍")])])],2)])],1)],1)},staticRenderFns:[]};var u=o("C7Lr")(k,d,!1,function(t){o("1vNL")},"data-v-0b760798",null);e.default=u.exports}});
//# sourceMappingURL=10.00b0361d205b14e9dc1a.js.map